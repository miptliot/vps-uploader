!function(a){"use strict";var b=function(c,d){var e=function(b,c){return this.text=a("<span/>"),this.bar=a("<div/>").addClass("progress-bar").attr("role","progressbar").attr("aria-valuemin","0").attr("aria-valuemax","100").append(this.text),this.set(0),b.append(a("<div/>").addClass("progress").append(this.bar)),this};e.prototype.set=function(a){0>a&&(a=0),a>100&&(a=100),this.bar.attr("aria-valuenow",a).css("width",a+"%"),this.text.html(a+"%")},e.prototype.remove=function(){this.bar.remove(),this.text.remove()};var f=function(b,c){b.attr("id","vu-"+c.id),this.id=c.id,this.name=a("<span/>").addClass("vu-file-name").html(c.name),this.size=a("<span/>").addClass("vu-file-size").html(g(c.size));var d=a("<span/>").addClass("vu-file-remove").click(function(){h(c.id)}).html("&times;");this.info=a("<div/>").addClass("vu-file-info").append(d).append(this.name).append(this.size);var f=a("<div/>").addClass("vu-file-progress");return this.progress=new e(f),this.element=b.append(this.info).append(f),this};f.prototype.remove=function(){this.info.remove(),this.progress.remove(),this.element.remove()};var g=function(a,b){if(0==a)return"0 Byte";var c=1024,d=b+1||3,e=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],f=Math.floor(Math.log(a)/Math.log(c));return(a/Math.pow(c,f)).toPrecision(d)+" "+e[f]},h=function(a){for(var b=0;b<o.files.length;b++)if(o.files[b].uniqueIdentifier==a){o.removeFile(o.files[b]);break}for(var b=0;b<j.length;b++)j[b].id==a&&(j[b].remove(),j.splice(b,1))},i=function(){for(var a=0;a<o.files.length;a++)o.removeFile(o.files[a]);for(var a=0;a<j.length;a++)j[a].remove();j=[],n.attr("disabled","disabled"),m.attr("disabled","disabled"),l.children("span").html(d.messages.select)};this.options=a.extend(!0,{},b.defaults,d);var j=[],k=a("<input/>").attr("type","file"),l=a("<div/>").addClass("btn btn-default vu-file-select").html(a("<span/>").html(d.messages.select)).append(k),m=a("<div/>").addClass("btn btn-primary").html(d.messages.upload).attr("disabled","disabled"),n=a("<div/>").addClass("btn btn-warning").html(d.messages.clear).click(function(){i()}).attr("disabled","disabled");c.append(a("<div/>").addClass("vu-controls").append(l).append(m).append(n));var o=new Flow({target:d.target,uploadMethod:"POST",chunkSize:d.chunksize,simultaneousUploads:20,query:d.query});return o.on("filesAdded",function(b,e){m.attr("disabled","disabled");for(var g=0;g<b.length;g++){var h=a("<div/>").addClass("vu-file-item");j.push(new f(h,{id:b[g].uniqueIdentifier,name:b[g].name,size:b[g].size})),c.append(h)}0==j.length?(n.attr("disabled","disabled"),m.attr("disabled","disabled"),l.children("span").html(d.messages.select)):(n.removeAttr("disabled"),m.removeAttr("disabled"),l.children("span").html(d.messages.add))}),o.assignBrowse(k),this};b.prototype.defaults={extensions:null,messages:{add:"Add files",clear:"Clear list",remove:"Remove file",select:"Select files",upload:"Upload"}},a.fn.uploader=function(c){return this.each(function(){new b(a(this),c)})}}(jQuery);